# æ‰¹é‡å¯¼å…¥é…ç½®æŒ‡å—

## ğŸ“ é…ç½®æ–‡ä»¶è¯´æ˜

### 1. subscriptions.conf - æœºåœºè®¢é˜…é…ç½®
ç”¨äºæ‰¹é‡ç®¡ç†æœºåœºè®¢é˜…é“¾æ¥ã€‚

**æ ¼å¼**: `è®¢é˜…åç§°|è®¢é˜…é“¾æ¥|æ˜¯å¦å¯ç”¨|å¤‡æ³¨`

**ç¤ºä¾‹**:
```
# æœºåœºè®¢é˜…é…ç½®æ–‡ä»¶
MyAirport|https://example.com/api/v1/client/subscribe?token=abc123|true|ä¸»è¦æœºåœº
BackupAirport|https://backup.example.com/subscribe/def456|false|å¤‡ç”¨æœºåœº
SpeedAirport|https://speed.example.com/sub?key=ghi789|true|é«˜é€Ÿæœºåœº
```

**å­—æ®µè¯´æ˜**:
- **è®¢é˜…åç§°**: è‡ªå®šä¹‰çš„æœºåœºåç§°ï¼Œç”¨äºè¯†åˆ«
- **è®¢é˜…é“¾æ¥**: æœºåœºæä¾›çš„è®¢é˜…URL
- **æ˜¯å¦å¯ç”¨**: `true`å¯ç”¨ï¼Œ`false`ç¦ç”¨
- **å¤‡æ³¨**: å¯é€‰ï¼Œç”¨äºè¯´æ˜

### 2. nodes.conf - å•ä¸ªèŠ‚ç‚¹é…ç½®
ç”¨äºæ‰‹åŠ¨æ·»åŠ å•ä¸ªä»£ç†èŠ‚ç‚¹ã€‚

#### VMess èŠ‚ç‚¹æ ¼å¼
```
vmess|èŠ‚ç‚¹åç§°|æœåŠ¡å™¨åœ°å€|ç«¯å£|ç”¨æˆ·ID|é¢å¤–ID|åŠ å¯†æ–¹å¼|ç½‘ç»œç±»å‹|è·¯å¾„|å¤‡æ³¨
```

**ç¤ºä¾‹**:
```
vmess|é¦™æ¸¯èŠ‚ç‚¹1|hk1.example.com|443|12345678-1234-1234-1234-123456789abc|0|auto|ws|/path|é«˜é€ŸèŠ‚ç‚¹
vmess|ç¾å›½èŠ‚ç‚¹1|us1.example.com|80|87654321-4321-4321-4321-210987654321|0|aes-128-gcm|tcp||ç¨³å®šèŠ‚ç‚¹
```

#### Shadowsocks èŠ‚ç‚¹æ ¼å¼
```
ss|èŠ‚ç‚¹åç§°|æœåŠ¡å™¨åœ°å€|ç«¯å£|å¯†ç |åŠ å¯†æ–¹å¼|å¤‡æ³¨
```

**ç¤ºä¾‹**:
```
ss|æ—¥æœ¬èŠ‚ç‚¹1|jp1.example.com|8388|mypassword123|aes-256-gcm|ä½å»¶è¿Ÿ
ss|æ–°åŠ å¡èŠ‚ç‚¹1|sg1.example.com|443|secretpass456|chacha20-ietf-poly1305|é«˜é€Ÿ
```

#### Trojan èŠ‚ç‚¹æ ¼å¼
```
trojan|èŠ‚ç‚¹åç§°|æœåŠ¡å™¨åœ°å€|ç«¯å£|å¯†ç |å¤‡æ³¨
```

**ç¤ºä¾‹**:
```
trojan|å¾·å›½èŠ‚ç‚¹1|de1.example.com|443|trojanpass123|ç¨³å®šè¿æ¥
trojan|è‹±å›½èŠ‚ç‚¹1|uk1.example.com|443|trojanpass456|è§£é”ä¸“ç”¨
```

## ğŸš€ ä½¿ç”¨æ–¹æ³•

### 1. ç¼–è¾‘é…ç½®æ–‡ä»¶
```bash
# ç¼–è¾‘è®¢é˜…é…ç½®
nano subscriptions.conf

# ç¼–è¾‘èŠ‚ç‚¹é…ç½®
nano nodes.conf
```

### 2. æ‰¹é‡å¯¼å…¥
```bash
# å¯¼å…¥æ‰€æœ‰é…ç½®ï¼ˆè®¢é˜…+èŠ‚ç‚¹ï¼‰
./batch_import.sh

# ä»…å¯¼å…¥è®¢é˜…
./batch_import.sh --subscriptions

# ä»…å¯¼å…¥èŠ‚ç‚¹
./batch_import.sh --nodes

# å¯¼å…¥å¹¶è‡ªåŠ¨é‡å¯æœåŠ¡
./batch_import.sh --all --restart
```

### 3. æŸ¥çœ‹å¯¼å…¥ç»“æœ
```bash
# æŸ¥çœ‹è®¢é˜…åˆ—è¡¨
proxy-manager sub list

# æŸ¥çœ‹æœåŠ¡çŠ¶æ€
proxy-manager status

# æŸ¥çœ‹é…ç½®
proxy-manager config
```

## ğŸ“‹ å®Œæ•´æ“ä½œæµç¨‹

### æ­¥éª¤1: å‡†å¤‡é…ç½®æ–‡ä»¶
1. ç¼–è¾‘ `subscriptions.conf`ï¼Œæ·»åŠ æ‚¨çš„æœºåœºè®¢é˜…
2. ç¼–è¾‘ `nodes.conf`ï¼Œæ·»åŠ å•ä¸ªèŠ‚ç‚¹ï¼ˆå¯é€‰ï¼‰

### æ­¥éª¤2: æ‰¹é‡å¯¼å…¥
```bash
# ä¸€é”®å¯¼å…¥æ‰€æœ‰é…ç½®å¹¶é‡å¯æœåŠ¡
./batch_import.sh --all --restart
```

### æ­¥éª¤3: éªŒè¯é…ç½®
```bash
# æ£€æŸ¥æœåŠ¡çŠ¶æ€
proxy-manager status

# æµ‹è¯•ä»£ç†è¿æ¥
curl --proxy http://127.0.0.1:7890 https://www.google.com
```

## ğŸ”§ é«˜çº§ç”¨æ³•

### è‡ªåŠ¨åŒ–å¯¼å…¥
åˆ›å»ºå®šæ—¶ä»»åŠ¡ï¼Œå®šæœŸæ›´æ–°è®¢é˜…ï¼š
```bash
# ç¼–è¾‘crontab
crontab -e

# æ·»åŠ å®šæ—¶ä»»åŠ¡ï¼ˆæ¯å¤©å‡Œæ™¨2ç‚¹æ›´æ–°ï¼‰
0 2 * * * cd /path/to/proxy && ./batch_import.sh --subscriptions --restart
```

### åˆ†ç¯å¢ƒé…ç½®
```bash
# ç”Ÿäº§ç¯å¢ƒé…ç½®
cp subscriptions.conf subscriptions.prod.conf
cp nodes.conf nodes.prod.conf

# æµ‹è¯•ç¯å¢ƒé…ç½®
cp subscriptions.conf subscriptions.test.conf
cp nodes.conf nodes.test.conf
```

### å¤‡ä»½é…ç½®
```bash
# å¤‡ä»½å½“å‰é…ç½®
cp subscriptions.conf subscriptions.conf.bak
cp nodes.conf nodes.conf.bak

# æ¢å¤é…ç½®
cp subscriptions.conf.bak subscriptions.conf
cp nodes.conf.bak nodes.conf
```

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **æ ¼å¼è¦æ±‚**:
   - ä½¿ç”¨ `|` åˆ†éš”å­—æ®µ
   - ä¸è¦åœ¨å­—æ®µä¸­åŒ…å« `|` å­—ç¬¦
   - ä»¥ `#` å¼€å¤´çš„è¡Œä¸ºæ³¨é‡Š

2. **å®‰å…¨å»ºè®®**:
   - ä¸è¦åœ¨é…ç½®æ–‡ä»¶ä¸­ä½¿ç”¨æ˜æ–‡å¯†ç 
   - å®šæœŸæ›´æ¢è®¢é˜…é“¾æ¥
   - å¤‡ä»½é‡è¦é…ç½®

3. **æ€§èƒ½ä¼˜åŒ–**:
   - ç¦ç”¨ä¸éœ€è¦çš„è®¢é˜…ï¼ˆè®¾ç½®ä¸º falseï¼‰
   - å®šæœŸæ¸…ç†æ— æ•ˆèŠ‚ç‚¹
   - ç›‘æ§æœåŠ¡èµ„æºä½¿ç”¨

4. **æ•…éšœæ’é™¤**:
   - æ£€æŸ¥é…ç½®æ–‡ä»¶æ ¼å¼
   - éªŒè¯è®¢é˜…é“¾æ¥æœ‰æ•ˆæ€§
   - æŸ¥çœ‹æœåŠ¡æ—¥å¿—

## ğŸ“ æŠ€æœ¯æ”¯æŒ

å¦‚é‡é—®é¢˜ï¼Œè¯·æ£€æŸ¥ï¼š
1. é…ç½®æ–‡ä»¶æ ¼å¼æ˜¯å¦æ­£ç¡®
2. ç½‘ç»œè¿æ¥æ˜¯å¦æ­£å¸¸
3. æœåŠ¡æ˜¯å¦æ­£å¸¸è¿è¡Œ
4. æŸ¥çœ‹è¯¦ç»†æ—¥å¿—ä¿¡æ¯

```bash
# æŸ¥çœ‹è¯¦ç»†æ—¥å¿—
journalctl -u sing-box -f

# æµ‹è¯•é…ç½®æ–‡ä»¶
sing-box check -c /etc/sing-box/config.json
```